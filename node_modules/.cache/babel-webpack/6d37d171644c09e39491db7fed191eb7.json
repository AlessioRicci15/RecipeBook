{"ast":null,"code":"\"use strict\";\n\nvar _asyncToGenerator = require(\"/Users/alessioricci/projects/udemy/udemy-app/node_modules/@babel/runtime/helpers/asyncToGenerator\").default;\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GuardsConsumer = void 0;\n\nconst shared_utils_1 = require(\"@nestjs/common/utils/shared.utils\");\n\nconst rxjs_1 = require(\"rxjs\");\n\nconst execution_context_host_1 = require(\"../helpers/execution-context-host\");\n\nclass GuardsConsumer {\n  tryActivate(guards, args, instance, callback, type) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (!guards || shared_utils_1.isEmpty(guards)) {\n        return true;\n      }\n\n      const context = _this.createContext(args, instance, callback);\n\n      context.setType(type);\n\n      for (const guard of guards) {\n        const result = guard.canActivate(context);\n\n        if (yield _this.pickResult(result)) {\n          continue;\n        }\n\n        return false;\n      }\n\n      return true;\n    })();\n  }\n\n  createContext(args, instance, callback) {\n    return new execution_context_host_1.ExecutionContextHost(args, instance.constructor, callback);\n  }\n\n  pickResult(result) {\n    return _asyncToGenerator(function* () {\n      if (result instanceof rxjs_1.Observable) {\n        return result.toPromise();\n      }\n\n      return result;\n    })();\n  }\n\n}\n\nexports.GuardsConsumer = GuardsConsumer;","map":null,"metadata":{},"sourceType":"script"}